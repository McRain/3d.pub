"use strict";(self.webpackChunk_reneos_3d_editor_engine=self.webpackChunk_reneos_3d_editor_engine||[]).push([[934],{934:(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r(472),n=r(470);class o extends n.DataTextureLoader{constructor(e){super(e),this.type=n.HalfFloatType}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},r=function(e,t,r){t=t||1024;let a=e.pos,n=-1,o=0,s="",i=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));for(;0>(n=i.indexOf("\n"))&&o<t&&a<e.byteLength;)s+=i,o+=i.length,a+=128,i+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));return-1<n&&(!1!==r&&(e.pos+=o+n+1),s+i.slice(0,n))},a=function(e,t,r,a){const n=e[t+3],o=Math.pow(2,n-128)/255;r[a+0]=e[t+0]*o,r[a+1]=e[t+1]*o,r[a+2]=e[t+2]*o,r[a+3]=1},o=function(e,t,r,a){const o=e[t+3],s=Math.pow(2,o-128)/255;r[a+0]=n.DataUtils.toHalfFloat(Math.min(e[t+0]*s,65504)),r[a+1]=n.DataUtils.toHalfFloat(Math.min(e[t+1]*s,65504)),r[a+2]=n.DataUtils.toHalfFloat(Math.min(e[t+2]*s,65504)),r[a+3]=n.DataUtils.toHalfFloat(1)},s=new Uint8Array(e);s.pos=0;const i=function(e){const a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,i={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=r(e)))&&t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),i.valid|=1,i.programtype=c[1],i.string+=l+"\n";l=r(e),!1!==l;)if(i.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(a))&&(i.gamma=parseFloat(c[1])),(c=l.match(n))&&(i.exposure=parseFloat(c[1])),(c=l.match(o))&&(i.valid|=2,i.format=c[1]),(c=l.match(s))&&(i.valid|=4,i.height=parseInt(c[1],10),i.width=parseInt(c[2],10)),2&i.valid&&4&i.valid)break}else i.comments+=l+"\n";return 2&i.valid||t(3,"missing format specifier"),4&i.valid||t(3,"missing image size specifier"),i}(s),l=i.width,c=i.height,p=function(e,r,a){const n=r;if(n<8||n>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);n!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const o=new Uint8Array(4*r*a);o.length||t(4,"unable to allocate buffer space");let s=0,i=0;const l=4*n,c=new Uint8Array(4),p=new Uint8Array(l);let h=a;for(;h>0&&i<e.byteLength;){i+4>e.byteLength&&t(1),c[0]=e[i++],c[1]=e[i++],c[2]=e[i++],c[3]=e[i++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==n||t(3,"bad rgbe scanline format");let r,a=0;for(;a<l&&i<e.byteLength;){r=e[i++];const n=r>128;if(n&&(r-=128),(0===r||a+r>l)&&t(3,"bad scanline data"),n){const t=e[i++];for(let e=0;e<r;e++)p[a++]=t}else p.set(e.subarray(i,i+r),a),a+=r,i+=r}const d=n;for(let e=0;e<d;e++){let t=0;o[s]=p[e+t],t+=n,o[s+1]=p[e+t],t+=n,o[s+2]=p[e+t],t+=n,o[s+3]=p[e+t],s+=4}h--}return o}(s.subarray(s.pos),l,c);let h,d,f;switch(this.type){case n.FloatType:f=p.length/4;const e=new Float32Array(4*f);for(let t=0;t<f;t++)a(p,4*t,e,4*t);h=e,d=n.FloatType;break;case n.HalfFloatType:f=p.length/4;const t=new Uint16Array(4*f);for(let e=0;e<f;e++)o(p,4*e,t,4*e);h=t,d=n.HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:h,header:i.string,gamma:i.gamma,exposure:i.exposure,type:d}}setDataType(e){return this.type=e,this}load(e,t,r,a){return super.load(e,(function(e,r){switch(e.type){case n.FloatType:case n.HalfFloatType:e.colorSpace=n.LinearSRGBColorSpace,e.minFilter=n.LinearFilter,e.magFilter=n.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)}),r,a)}}function s(e){return new Promise((t=>{(new o).load(e.url,(e=>{e.mapping=a.EquirectangularReflectionMapping,t(e)}))}))}}}]);