"use strict";(self.webpackChunk_reneos_3d_player_engine=self.webpackChunk_reneos_3d_player_engine||[]).push([[173,614],{287:(t,e,s)=>{s.d(e,{A:()=>r});var i=s(140);const n={goto:function(t,e,s){i.A.GoTo(t.slide)},gonext:function(t,e,s){i.A.GoToNext()},goback:function(t,e,s){i.A.GoToBack()},func:function(t,e){let s=e;if(t.paths)for(let e=0;e<t.paths.length;e++)s=s[t.paths[e]];return s[t.method](t.values,e)},visible:async function(t,e,s){let i=e;if(t.paths)for(let e=0;e<t.paths.length;e++)i=i[t.paths[e]];if(t.target)for(let e=0;e<t.target.length;e++)i=i.children.find((s=>s.uid===t.target[e]));i.visible=t.value,i.dispatchEvent({target:i,type:"visible",value:i.visible})},propset:function(t,e,s){let i=e;for(let e=0;e<t.paths.length;e++)i=i[t.paths[e]];i[t.property]=t.value}},a={goto:{uid:"goto",type:"goto",handler:n.goto},gotoNext:{uid:"gotoNext",type:"gonext",handler:n.gonext},gotoBack:{uid:"gotoBack",type:"goback",handler:n.goback},callFunc:{uid:"callFunc",type:"func",handler:n.func},cameraSet:{uid:"cameraSet",type:"func",handler:n.func,paths:["model"],method:"activate",values:{}},visibleSet:{uid:"visibleSet",type:"visible",handler:n.visible,paths:[]},propset:{uid:"propset",type:"propset",handler:n.propset}};async function o(t,e){for(const s of t){const t=a[s.uid];await t.handler({...t,...s},e,s),s.actions&&await o(s.actions,e)}}const r=class{static get Library(){return a}static Init(t){Object.entries(t).forEach((([t,e])=>{e.handler=n[e.type],a[t]=e}))}static GetAction(t){return n[t]}static RegisterAction(t,e){n[t]=e,Object.values(a).forEach((e=>{e.type===t&&(e.handler=n[e.type])}))}static async Run(t=[],e,s){const i=t.filter((t=>t.hook===s));0!==i.length&&await o(i,e)}static async Execute(t,e){const s=[];for(let i=0;i<t.length;i++){const n=t[i],a=n.actions.filter((t=>t.hook===e));a.length>0&&s.push(o(a,n))}await Promise.all(s)}}},304:(t,e,s)=>{s.d(e,{A:()=>l});const i=class{constructor(t){this.data=t,this.resource=null,this.promise=null,this.elements=[]}async load(){}updateResource(t,e){this.resource=t,this.applyData(e||this.data)}get uid(){return this.data.uid}};var n=s(92);var a=s(922);var o=s(231);const r=new Map,c={gltf:class extends i{constructor(t){super(t)}async load(){await new Promise((t=>{(new n.B).load(this.data.url,(async e=>{let s;this.resource=e.scene.children.length>1?e.scene:e.scene.children[0],this.data.transform?.position&&this.resource.position.copy(this.data.transform.position),this.data.transform?.rotation&&this.resource.rotation.set(this.data.transform.rotation.x,this.data.transform.rotation.y,this.data.transform.rotation.z,"XYZ"),this.data.transform?.scale&&this.resource.scale.copy(this.data.transform.scale),this.data.envMap&&(s=await l.GetResource(this.data.envMap)),this.resource.traverse((t=>{t.isMesh&&(this.data.envMap&&(t.material.envMap=s,t.material.envMapIntensity=.75),t.castShadow=!0,t.receiveShadow=!0,t.geometry.computeBoundingBox())})),t()}))}))}setElement(t,e={}){this.elements.push({element:t,data:e}),t.add(this.resource.clone()),this.applyData(e)}updateResource(t,e){super.updateResource(t,e);for(let e=0;e<this.elements.length;e++){const e=this.elements,s=e.element.children.find((t=>t.uid===this.data.uid));s!==t&&(e.element.remove(s),e.element.add(this.resource.clone())),this.applyData(e.data)}}async applyData(t){let e;this.resource.position.copy(t.transform?.position||{x:0,y:0,z:0}),this.resource.rotation.setFromVector3(t.transform?.rotation||{x:0,y:0,z:0},"XYZ"),this.resource.scale.copy(t.transform?.scale||{x:1,y:1,z:1}),t.transform?.quaternion&&this.resource.quaternion.copy(t.transform.quaternion),t.envMap&&(e=await l.GetAsset(t.envMap).resource),this.resource.traverse((s=>{s.isMesh&&(t.envMap&&(s.material.envMap=e),s.castShadow=t.shadow?.cast||!1,s.receiveShadow=t.shadow?.receive||!1,s.geometry.computeBoundingBox())}))}destroy(){for(let t=0;t<this.elements.length;t++){const t=this.elements;t.elements.children.find((t=>t.uid===this.data.uid))&&t.elements.remove(this.resource)}}},texture:class extends i{constructor(t){super(t)}async load(){const t=new a.Tap;this.resource=await t.load(this.data.url)}setElement(t,e={}){this.element=t,this.elementData=e,this.element.add(this.resource),this.applyData(this.data),this.applyData(this.elementData)}updateResource(t,e){this.element.children.find((t=>t.uid===this.data.uid))!==t&&(this.element.remove(this.resource),this.resource=t,this.element.add(this.resource)),this.applyData(e),this.applyData(this.elementData)}destroy(){this.element.children.find((t=>t.uid===this.data.uid))&&this.element.remove(this.resource)}},hdr:class extends i{constructor(t){super(t)}load(){return new Promise((t=>{(new o.Y).load(this.data.url,(e=>{e.mapping=a.wfO,this.resource=e,t()}))}))}setElement(t,e={}){this.element=t,this.elementData=e,this.element.add(this.resource),this.applyData(this.data),this.applyData(this.elementData)}updateResource(t,e){this.element.children.find((t=>t.uid===this.data.uid))!==t&&(this.element.remove(this.resource),this.resource=t,this.element.add(this.resource)),this.applyData(e),this.applyData(this.elementData)}destroy(){this.element.children.find((t=>t.uid===this.data.uid))&&this.element.remove(this.resource)}},material:class extends i{constructor(t){super(t),this.resource=new a._4j,this.elements=[]}async load(){Object.keys(this.data.textures).forEach((async t=>{this.resource[t]=await l.GetResource(this.data.textures[t].uid)})),Object.keys(this.data.properties).forEach((async t=>{this.resource[t]=this.data.properties[t]}))}setElement(t,e={}){this.elements.push({element:t,data:e}),t.add(this.resource.clone()),this.applyData(e)}updateResource(t,e){for(let s=0;s<this.elements.length;s++){const s=this.elements;s.element.children.find((t=>t.uid===this.data.uid))!==t&&(s.element.remove(this.resource),this.resource=t,s.element.add(this.resource.clone())),this.applyData(e),this.applyData(s.data)}}}},l=class{static GetAsset(t){return r.get(t)}static GetAssets(t){const e=new Set(t);return[...r.values()].filter((t=>e.has(t.uid)))}static GetResource(t){const e=r.get(t);return e.resource?e.resource:(e.promise||(e.promise=new Promise((async t=>{await e.load(),t(e.resource)}))),e.promise)}static async Init(t){for(let e=0;e<t.length;e++){const s=t[e],i=new(0,c[s.type])(s);r.set(i.uid,i)}const e=[];for(const[t,s]of r.entries())e.push(s.load());await Promise.allSettled(e)}static RemoveAsset(t){r.has(t.uid)&&(r.get(t.uid).destroy(),r.delete(t.uid))}}},127:(t,e,s)=>{s.d(e,{A:()=>h});var i=s(922),n=s(74),a=s(351),o=s(404);let r;new i.I9Y;const c=new a.A;let l;class d{static Init(t,e){l=e,r=new n.B({element:t}),r.setSize(window.innerWidth,window.innerHeight),r.domElement.style.position="absolute",r.domElement.style.top="0px",o.A.AddToUpdate(d.Render)}static async AddElement(t,e){const s=await l(e),i=new n.v(s);return i.position.set(0,e.offset.y,0),i.center.set(.5,.5),i.layers.set(0),c.emit("add",i,t),i}static AddLabel(t,e){const s=new n.v(t);return s.position.set(0,0,0),s.center.set(.5,.5),s.layers.set(0),s}static AddHookLine(t,e){}static UpdateHook(t){let e=function(t,e){let s=t.getBoundingClientRect();console.log(t),console.log(s),console.log(s.top,s.right,s.bottom,s.left);let n=t.offsetParent?t.offsetParent.getBoundingClientRect():{left:0,top:0},a=(s.left-n.left+s.width/2)/window.innerWidth*2-1,o=-(s.top-n.top+s.height/2)/window.innerHeight*2+1,r=new i.Pq0(a,o,-2);r.unproject(e);let c=r.sub(e.position).normalize();return e.position.clone().add(c.multiplyScalar(3))}(t.div,o.A.Camera,o.A.Scene);t.points[1].copy(e),t.line.geometry.setFromPoints(t.points)}static Render(){r.render(o.A.Scene,o.A.Camera)}}const h=new Proxy(d,{get:(t,e)=>e in t?t[e]:c[e]})},30:(t,e,s)=>{s.d(e,{A:()=>o});var i=s(922),n=s(475);class a extends i.B69{static get IsElement(){return!0}constructor(t){super(),this.isElement=!0,this.isBase=!0,this.uid=t.uid,this.data=t,this.type="element",this.actions=t.actions||[],this.transform=new n.A(this,!1),this.transform.parent=this,t.transform&&Object.keys(t.transform).forEach((e=>{this.transform[e]=t.transform[e]}))}addAction(t){this.actions.push(t)}get model(){return this}get visible(){return super.visible}set visible(t){super.visible=t}addElement(t,e,s,i){s===this?(this.add(e),t.transform?.position&&e.position.copy(i[t.transform.position]||t.transform.position),t.transform?.scale&&e.scale.copy(i[t.transform.scale]||t.transform.scale)):s.addElement(t,e,s,i)}}const o=a},314:(t,e,s)=>{s.r(e),s.d(e,{default:()=>a});var i=s(30);class n extends i.A{constructor(t){super(t),this.isBlock=!0,this.type="block"}}const a=n},539:(t,e,s)=>{s.d(e,{$7:()=>h,C6:()=>n.A,Kx:()=>a.default});var i=s(922),n=s(30),a=s(614),o=s(304);s(475);const r={PlaneGeometry:i.bdM,SphereGeometry:i.Gu$,BoxGeometry:i.iNn,BufferGeometry:i.LoY,Group:i.YJl,Object3D:i.B69,PerspectiveCamera:i.ubm,OrthographicCamera:i.qUd,InstancedMesh:i.ZLX,Mesh:i.eaF,DirectionalLight:i.ZyN,AmbientLight:i.$p8,Color:i.Q1f,Vector3:i.Pq0,Vector2:i.I9Y,Quaternion:i.PTz,Matrix4:i.kn4,MeshLambertMaterial:i.G_z,MeshPhysicalMaterial:i.uSd,MeshStandardMaterial:i._4j,BufferAttribute:i.THS},c=[{types:["block"],module:()=>Promise.resolve().then(s.bind(s,314))},{types:["model"],module:()=>Promise.resolve().then(s.bind(s,614))},{types:["camera"],module:()=>s.e(740).then(s.bind(s,740))},{types:["directlight"],module:()=>s.e(296).then(s.bind(s,296))},{types:["material"],module:t=>t=>{console.log(t)}},{types:["uielement"],module:()=>s.e(229).then(s.bind(s,229))}],l={},d={};class h{static AddImporter(t,e){c.push({types:t,handler:e})}static AddTemplate(t){l[t.id]=element}static AddTemplates(t){t.forEach((t=>{l[t.id]=t}))}static GetElementProp(t,e){let s=d[t];const i=e.split(".");for(let t=0;t<i.length;t++)s=s[i[t]];return s}static async UpdateElement(t,e){const s=d[t];Object.keys(e).forEach((async t=>{s[t]=await h.CreateElement(e[t])}))}static async CreateElement(t){if(null==t)return null;let e=t;if("object"==typeof t){const{type:s,properties:i,asset:n}=t;if(s){let i;const{args:n,...a}=t,l=c.find((t=>t.types.includes(s.toLowerCase())));if(l){const e=l.handler?l.handler(t):await l.module();i=e.default||e}else r[s]&&(i=r[s]);if(Array.isArray(n)){const t=await Promise.all(n.map((t=>h.CreateElement(t))));e=new i(...t)}else n?e=new i(Object.fromEntries(await Promise.all(Object.entries(n).map((async([t,e])=>[t,await h.CreateElement(e)]))))):r[s]||(e=new i(a));if(a.assets){const t=o.A.GetAssets(a.assets.map((t=>t.uid)));e.setAssets(t,a.assets)}e.isObject3D&&(e.isElement||(e.actions=[],e.isElement=!0),e.paths=t.paths)}else n&&(e=await o.A.GetResource(n));i&&await Promise.all(Object.entries(i).map((async([t,s])=>{e[t]=await h.CreateElement(s)})))}return e}static async BuildElements(t,e){const s=[];for(let i=0;i<t.length;i++){const n=t[i],a=await h.BuildElement(n,e);s.push(a)}return s}static async BuildElement(t,e){const s=structuredClone(l[t.template]?{...l[t.template],...t}:JSON.parse(JSON.stringify(t))),{uid:i,name:n}=s,a=await h.CreateElement(s);if(a)return a.uid=i,a.name=n||i,a.path=e.path?`${e.path}.${i}`:i,e&&(e.addChild||e.add).bind(e)(a),t.children&&await h.BuildElements(t.children,a),d[a.uid]=a,a.init&&await a.init(),a}}},614:(t,e,s)=>{s.r(e),s.d(e,{default:()=>a});var i=s(30);class n extends i.A{constructor(t){super(t),this.isModel=!0,this.type="model"}setAssets(t,e){for(let s=0;s<e.length;s++)this.add(...t.map((t=>t.resource.clone())))}removeAsset(t){const e=this.children.find((e=>e.uid===t));e&&this.remove(e)}addAsset(t,e){e.position.copy(t.transform?.position||{x:0,y:0,z:0}),e.rotation.setFromVector3(t.transform?.rotation||{x:0,y:0,z:0},"XYZ"),e.scale.copy(t.transform?.scale||{x:1,y:1,z:1}),t.transform?.quaternion&&e.quaternion.copy(t.transform?.quaternion),e.traverse((t=>{t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0,t.geometry.computeBoundingBox())})),this.add(e)}find(t){const e=t.split(".");let s=this;for(let t=0;t<e.length;t++)s=this.children.find((s=>s.uid===e[t])),list=s.children;return s}}const a=n},475:(t,e,s)=>{s.d(e,{A:()=>o});var i=s(351),n=s(922);class a extends i.A{constructor(t){super(),this.model=t}create(t,e){this[`_${t}`]=e}clean(t){delete this[`_${t}`]}update({position:t,rotation:e,scale:s,quaternion:i}){this.position=t,this.rotation=e,this.quaternion=i,this.scale=s,this.emit("change",this,["position","rotation","scale"])}get position(){return this._position}set position(t){this._position=this._position?this._position.copy(t):(new n.Pq0).copy(t),this.model.position.copy(this._position),this.emit("change",this,["position"])}get rotation(){return this._rotation}set rotation(t){this._rotation=this._rotation?this._rotation.set(t.x,t.y,t.z,"XYZ"):new n.O9p(t.x,t.y,t.z,"XYZ"),this.model.rotation.set(this._rotation.x,this._rotation.y,this._rotation.z,"XYZ"),this.emit("change",this,["rotation"])}get quaternion(){return this._quaternion}set quaternion(t){this._quaternion=this._quaternion?this.quaternion.copy(t):new n.PTz(t.x,t.y,t.z,t.w),this.model.quaternion.set(this._quaternion.x,this._quaternion.y,this._quaternion.z,this._quaternion.w),this.emit("change",this,["rotation"])}get scale(){return this._scale}set scale(t){this._scale=this._scale?this._scale.copy(t):(new n.Pq0).copy(t),this.model.scale.copy(this._scale),this.emit("change",this,["scale"])}}const o=a},351:(t,e,s)=>{s.d(e,{A:()=>i});const i=class{constructor(){this._events={"*":[]}}subs(t,e,s){null==this._events[t]&&(this._events[t]=[]),this._events[t].push({handler:s,once:e})}on(t,e){this.subs(t,!1,e)}once(t,e){this.subs(t,!0,e)}off(t,e){const s=this._events[t];if(s){for(let t=s.length-1;t>=0;t--)s[t].handler===e&&s.splice(t,1);0===s.length&&delete this._events[t]}}clear(t){this._events[t]=[]}clearAll(){this._events={"*":[]}}emit(t,...e){const s=[];this._events[t]&&s.push(...this._events[t]),this._events["*"].length&&s.push(...this._events["*"].map((e=>({handler:e.handler.bind(this,t),once:e.once}))));for(let t=s.length-1;t>=0;t--){const i=s[t];i.handler.apply(null,e),i.once&&s.splice(t,1)}}addEventListener(t,e){this.on(t,e)}removeEventListener(t,e){this.off(t,e)}}},173:(t,e,s)=>{s.r(e),s.d(e,{ActionsManager:()=>l.A,AssetsManager:()=>a.A,BaseElement:()=>n.C6,CssManager:()=>d.A,ElementModel:()=>n.Kx,Factory:()=>n.$7,MouseManager:()=>c.A,ProjectManager:()=>r.A,SlidesManager:()=>o.A,THREE:()=>i});var i=s(437),n=s(539),a=s(304),o=(s(314),s(140)),r=s(404),c=s(337),l=s(287),d=s(127)},337:(t,e,s)=>{s.d(e,{A:()=>C});var i=s(922),n=s(351);function a(t){for(;t;){if(t.isBlock)return t;t=t.parent}return null}var o=s(24);let r,c;const l=class{static MoveTo(t,e){const s={position:new i.Pq0,time:1e3,...t,control:!1},n={position:new i.Pq0,time:1e3,...e,control:!1};r.enabled=!1;const a=Workspace.Camera.position.clone(),o=r.target.clone();s.control=s.time>n.time,n.control=n.time>=s.time;const c=new Tween(a).to(s.position,s.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{Workspace.Camera.position.copy(a),Workspace.Camera.updateProjectionMatrix(),r.update()})).onComplete((()=>{s.control&&(r.enabled=!0),tweengroup.remove(c)})).start(),l=new Tween(o).to(n.position,n.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{r.target.copy(o),r.getPolarAngle()>r.maxPolarAngle&&r.target.setY(center.y+Math.cos(r.maxPolarAngle)*distance)})).onComplete((()=>{n.control&&(r.enabled=!0),tweengroup.remove(l)})).start();tweengroup.add(c,l)}static SetState(t){r.enabled=t}static Target(t){r.target.copy(t)}static Init({canvas:t},e,s){r&&s.remove(r),r=new o.N(e,t),r.enabled=!0,r.enableDamping=!0,r.dampingFactor=.25,r.screenSpacePanning=!1,r.minDistance=.01,r.maxDistance=500}static ChangeCamera(t){r.object=t}static get Transformer(){return c}static Select(t){t?c.attach(t):c.detach()}static Update(t){r.update(t)}static FitTo({center:t,radius:e}){const s=i.cj9.degToRad(Workspace.Camera.fov),n=e/Math.sin(s/2),a=(new i.Pq0).subVectors(Workspace.Camera.position,t).normalize(),o=t.clone().add(a.multiplyScalar(n)),c=Workspace.Camera.position.clone();r.enabled=!1;const l=r.target.clone(),d=new Tween(l).to(t,1e3).easing(Easing.Quadratic.InOut).onUpdate((()=>{r.target.copy(l),r.getPolarAngle()>r.maxPolarAngle&&r.target.setY(t.y+Math.cos(r.maxPolarAngle)*distance)})).start(),h=new Tween(c).to(o,1e3).easing(Easing.Quadratic.InOut).onUpdate((()=>{Workspace.Camera.position.copy(c);const e=Workspace.Camera.position.distanceTo(t);e<r.minDistance?Workspace.Camera.position.copy(t.clone().add(a.clone().multiplyScalar(r.minDistance))):e>r.maxDistance&&Workspace.Camera.position.copy(t.clone().add(a.clone().multiplyScalar(r.maxDistance))),Workspace.Camera.updateProjectionMatrix(),r.update()})).onComplete((()=>{r.enabled=!0,tweengroup.remove(h,d)})).start();tweengroup.add(h,d)}},d=new i.tBo,h=new n.A;let u,p,m,f;const y={x:0,y:0};let g,w=.03,v=.03,A=.01,b=.01,x=window.innerWidth/2,E=window.innerHeight/2;function _(t){}function S(t){y.x=t.clientX,y.y=t.clientY,g=Date.now()}function P(t){if(Math.abs(y.x-t.clientX)>10||Math.abs(y.y-t.clientY)>10||Date.now()-g>500)return;const e=t.clientX/window.innerWidth,s=-t.clientY/window.innerHeight,n=new i.I9Y;n.x=2*e-1,n.y=2*s+1,d.setFromCamera(n,p);const o=d.intersectObjects(u.children,!0);if(0===o.length)return;const r=[];for(let t=0;t<o.length;t++){const e=a(o[t].object);if(e.visible&&!r.includes(e))return r.push(e),void h.emit("click",e)}}const C=new Proxy(class{static get Control(){return l}static Init(t,e,s,i,n){const a={camera:{range:{x:.01,y:.01},movespeed:{x:.03,y:.03}},...n};u=i,m=s,p=e,f=t,w=a.camera.movespeed.x,v=a.camera.movespeed.y,A=a.camera.range.x,b=a.camera.range.y,x=window.innerWidth/2,E=window.innerHeight/2,t.addEventListener("click",P.bind(null)),t.addEventListener("mousemove",_,!1),t.addEventListener("mousedown",S,!1)}static Update(t){}static SetCamera(t){p=t}},{get:(t,e)=>e in t?t[e]:h[e]})},404:(t,e,s)=>{s.d(e,{A:()=>b});var i=s(922),n=s(437),a=s(351),o=s(539),r=s(304),c=s(337),l=s(287);let d,h,u,p,m,f,y,g=[];const w=new a.A,v=[];function A(t){for(let e=0;e<g.length;e++)g[e](t);p.render(u,f)}const b=new Proxy(class{static get Root(){return m}static get Scene(){return u}static get Camera(){return f}static get Canvas(){return d}static Init(t){d=t,h=new i.zD7,u=new i.Z58,p=new n.WebGLRenderer({canvas:t,alpha:!0,powerPreference:"high-performance",antialias:!0,stencil:!1});const e=d.clientWidth,s=d.clientHeight;p.setSize(e,s,!1),p.setPixelRatio(window.devicePixelRatio),p.shadowMap.enabled=!0,p.shadowMap.type=i.Wk7,m=new i.B69,u.add(m),y=m.position.clone()}static async Start(){f=new i.ubm(60,window.innerWidth/window.innerHeight,.01,1e3),f.uid="EditorCamera",u.add(f),f.position.set(0,10,20),p.setAnimationLoop(A),f.layers.enable(1),c.A.Init(p.domElement,f,u,m),c.A.on("click",(t=>{l.A.Run([...t.actions,...t.state.actions],t,"mouse.click.self")})),g.push(c.A.Update),u.background=await r.A.GetAsset("hdrscene").resource}static AddToUpdate(t){g.push(t)}static SetCamera(t){f.visible=!1,f=t,f.visible=!0,c.A.SetCamera(f)}static async Build(t){const e=await o.$7.BuildElements(t,m);return e.forEach((t=>t.visible=!1)),v.push(...e),e}static FindBlock(t){return v.find((e=>e.uid===t))}static FindElement(t){let e=v.find((e=>e.uid===t[0]));for(let s=1;s<t.length;s++)e=e.children.find((e=>e.uid===t[s]));return e}static async SetAsset(t,e){const s=await r.A.GetAsset({uid:e.uid}),i=t.split(".");let n=v.find((t=>t.uid===i[0]));for(let t=1;t<i.length;t++)n=n.children.find((e=>e.uid===i[t]));n.addAsset(e,s)}static RemoveAsset(t,e){const s=t.split(".");let i=v.find((t=>t.uid===s[0]));for(let t=1;t<s.length;t++)i=i.children.find((e=>e.uid===s[t]));i.removeAsset(e)}static RemoveElement(t){const e=t.split(".");let s=v;for(let t=0;t<e.length-1;t++){const i=s.find((s=>s.uid===e[t]));s=i.children}const i=s.findIndex((e=>e.path===t));if(i>=0){const t=s.splice(i,1);t[0].parent.remove(t[0])}}},{get:(t,e)=>e in t?t[e]:w[e]})},140:(t,e,s)=>{s.d(e,{A:()=>f});var i=s(475),n=s(404),a=s(287),o=s(351);const r=[],c=[];let l;const d=new o.A;class h{static AddSlides(t){const e=[];for(let s=0;s<t.length;s++){const i=h.AddSlide(t[s]);e.push(i)}return e}static AddSlide(t){const e=new u(t);for(let s=0;s<t.children.length;s++){const i=t.children[s],a=new p(i,n.A.FindBlock(i.uid));a.slide=e,e.addState(a)}return r.push(e),e}static AddState(t,e=!0){const s=new p(t,n.A.FindBlock(t.uid));return e&&(s.model.visible=!0),s}static UpdateState(t,e,s){r.find((e=>e.uid===t)).children.find((t=>t.uid===e)).update(s)}static RemoveState(t,e){for(let s=0;s<r.length;s++){const i=r[s];if(e&&i.uid!==e)continue;const n=i.children.findIndex((e=>e.path===t));if(n>=0){const t=i.children.splice(n,1);e&&t.forEach((t=>t.model.visible=!1))}}}static GoTo(t){const e="number"==typeof t?r[t]:r.find((e=>e.uid===t));e&&l?.uid!==e.uid&&(c[c.length-1]!==e.uid&&c.push(e.uid),h.Activate(e))}static GoToNext(){const t=r.findIndex((t=>t===l));h.GoTo(t+1)}static GoToBack(){c.pop(),h.GoTo(c[c.length-1])}static async Activate(t,e=!1){let s=[];l&&(l.ready=!1,s=l.children,await l.out(t.children,!e)),l=t,d.emit("change",l),await l.in(s,!e)}}class u{constructor(t){this.uid=t.uid,this.name=t.name,this.scene=t.scene,this.camera=t.camera,this.type=t.type||"slide",this.isSlide=!0,this.children=[],this.ready=!0,this._actions=t.actions}addState(t){this.children.push(t),t.slide=this}async in(t,e=!0){const s=[],i=[];for(let e=0;e<this.children.length;e++){const n=this.children[e];t.findIndex((t=>t.uid===n.uid||n.data.persistent))>=0?i.push(n):s.push(n)}const n=[...s,...i];n.filter((t=>!0===t.data.visible||!1===t.data.visible)).forEach((t=>t.activate())),await Promise.all([a.A.Execute(n,"slide.in.before"),a.A.Run(this._actions,this,"slide.in.before")]),await a.A.Execute(s,"enable.on"),await Promise.all([a.A.Execute(n,"slide.in"),a.A.Run(this._actions,this,"slide.in")]),await Promise.all([a.A.Execute(n,"slide.in.after"),a.A.Run(this._actions,this,"slide.in.after")])}async out(t){const e=[],s=[];for(let i=0;i<this.children.length;i++){const n=this.children[i];t.findIndex((t=>t.uid===n.uid))>=0?e.push(n):s.push(n)}const i=[...s,...e];await Promise.all([a.A.Execute(i,"slide.out"),a.A.Run(this._actions,this,"slide.out")]),await a.A.Execute(s,"disable.on"),s.forEach((t=>t.deactivate()))}}class p{constructor(t,e){this.uid=e.uid,this.path=e.path,this.isState=!0,this.type="state",this.data=t,this.model=e,this.transform=new i.A(e),this.transform.parent=this,this.visible=t.visible,this._actions=t.actions||[]}addAction(t){this._actions.push(t)}get stateActions(){return this._actions}get actions(){return[...this._actions,...this.model.actions]}async activate(){this.data.transform&&(this.data.transform.position&&this.model.position.copy(this.data.transform.position),this.data.transform.rotation&&this.model.rotation.setFromVector3(this.data.transform.rotation,"XYZ"),this.data.transform.scale&&this.model.scale.copy(this.data.transform.scale)),this.model.state=this,!0!==this.visible&&!1!==this.visible||(this.model.visible=this.visible)}deactivate(){this.model.visible=!1}}const m=new Proxy(h,{get:(t,e)=>e in t?t[e]:d[e]});window.SlidesManager=m;const f=m}}]);