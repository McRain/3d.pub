"use strict";(self.webpackChunk_reneos_3d_mod_tweens=self.webpackChunk_reneos_3d_mod_tweens||[]).push([[84,234],{70:(e,t,a)=>{a.d(t,{A:()=>r});const o=new(a(816).Group);let l=!1;class n{static get Group(){return o}static Add(e){o.add(e),l||(l=!0,n.Update())}static Remove(e){o.remove(e),0===o.getAll().length&&(l=!1)}static Update(e){l&&(o.update(e),requestAnimationFrame(n.Update))}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static ToRadiansV3(e){return{x:e.x*Math.PI/180,y:e.y*Math.PI/180,z:e.z*Math.PI/180}}}const r=n},262:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,o]of t)a[e]=o;return a}},470:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var o=a(816),l=a(70),n=a(922);const r=`${Date.now()}_${Math.random()}`;function i(e,t,a=!1){return new Promise((i=>{e.tween&&e.tween.uid===r&&(e.tween.stop(),l.A.Remove(e.tween));let c=t;try{e.paths&&e.paths.forEach((e=>{if(!c)throw new Error(`Target is null at path ${e}`);c=c[e]})),e.target&&e.target.forEach((e=>{if(!c?.children)throw new Error("No children in target");const t=c.children.find((t=>t.uid===e));if(!t)throw new Error(`Child with uid ${e} not found`);c=t}))}catch(e){return console.error("Target resolution error:",e),i()}if(!c?.model)return console.error("Target model not found"),i();const s=(e,t,a)=>{const o="accurate"===t?l.A.ToRadiansV3({...e}):{x:(a?.x||0)+l.A.ToRadians(e?.x||0),y:(a?.y||0)+l.A.ToRadians(e?.y||0),z:(a?.z||0)+l.A.ToRadians(e?.z||0)};return new n.O9p(o.x,o.y,o.z,"XYZ")};let d=e.rotation||c.data?.rotation||c.model.data?.rotation;if("target"===e.to?.type)try{let a=t.slide||t;for(const t of e.to.paths||[]){if(!a?.children)throw new Error("No children in intermediate target");if(a=a.children.find((e=>e.uid===t)),!a)throw new Error(`Target with uid ${t} not found`)}d=a.rotation||a.model.rotation}catch(e){return console.error("Target rotation resolution error:",e),i()}const u=s(e.from.value,e.from.type,c.model.rotation),p=s(e.to?.value||{},e.to?.type,d),m=(new n.PTz).setFromEuler(u),v=(new n.PTz).setFromEuler(p),y=m.clone();c.model.quaternion.copy(m);const h={t:0};e.tween=new o.Tween(h).to({t:1},a?0:e.time||1e3).delay(a?0:e.delay||0).easing(o.Easing.Quadratic.InOut).yoyo(Boolean(e.yoyo)).repeat(e.repeat||0).onUpdate((()=>{y.copy(m).slerp(v,h.t),c.model.quaternion.copy(y)})).onComplete((()=>{l.A.Remove(e.tween),e.tween=null,i()})).onStop((()=>{l.A.Remove(e.tween),e.tween=null,i()})),e.tween.uid=r,l.A.Add(e.tween),e.tween.start()}))}},652:(e,t,a)=>{a.d(t,{A:()=>r});var o=a(27);const l={style:{display:"flex","flex-wrap":"nowrap",gap:"10px","justify-content":"flex-end"}},n={props:{repeat:{type:[Number],required:!0}},computed:{rep:{get(){return this.repeat},set(e){this.$emit("update:repeat",e)}}},watch:{infin(e){this.$emit("update:repeat",e?1/0:this.inputRepeat)}},data(){return{inputRepeat:this.repeat,infin:!1}}},r=(0,a(262).A)(n,[["render",function(e,t,a,n,r,i){const c=(0,o.resolveComponent)("icon");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[r.infin?(0,o.createCommentVNode)("v-if",!0):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:0,style:{width:"42px",height:"0.98em"},type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>i.rep=e),min:"0"},null,512)),[[o.vModelText,i.rep,void 0,{number:!0}]]),(0,o.createVNode)(c,{style:(0,o.normalizeStyle)({opacity:r.infin?1:.5}),value:"infinite",size:"1em"},null,8,["style"]),(0,o.withDirectives)((0,o.createElementVNode)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.infin=e),type:"checkbox"},null,512),[[o.vModelCheckbox,r.infin]])])}]])},865:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var o=a(27);const l={class:"vertflex"},n={class:"flex-fit",style:{"justify-content":"center"}},r={class:"flex-line"},i={class:"line-title"},c={class:"value-title"},s={class:"flex-fit"},d={class:"flex-line"},u={class:"line-title"},p={class:"value-title"},m={class:"flex-fit"},v={class:"flex-line"},y={class:"value-title"},h={class:"flex-line"},f={class:"value-title"},V={class:"flex-line"},N={class:"value-title"},E={class:"flex-line"},g={class:"value-title"},w=["value"],k={key:0,class:"flex-fit",style:{"justify-content":"center"}};var x=a(470),C=a(652);const $={name:"TweenRotate",props:{name:{type:String},from:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},to:{type:Object,default:{type:"accurate",value:{x:0,y:0,z:0}}},delay:{type:Number},time:{type:Number},easing:{type:String,default:"Easing.Linear.InOut"},repeat:{type:Number},yoyo:{type:Boolean},inspector:{type:Boolean}},data:()=>({played:!1}),computed:{fromtype:{get(){return this.from.type},set(e){this.$emit("update","from",{value:this.fromvalue,type:e})}},fromvalue:{get(){return this.from.value},set(e){this.$emit("update","from",{value:e,type:this.fromtype})}},totype:{get(){return this.to.type},set(e){this.$emit("update","to.type",e)}},tovalue:{get(){return this.to.value},set(e){this.$emit("update","to",{value:e,type:this.totype})}},easingval:{get(){return this.easing},set(e){this.$emit("update","easing",e)}},target(){return this.$app.selection.selected}},methods:{copyFromModel(e){const t=this.target.model.rotation.clone();e.value.x=t.x,e.value.y=t.y,e.value.z=t.z},reset(){const e=this.target.rotation||this.target.model.rotation;this.target.model?this.target.model.rotation.copy(e,"XYZ"):this.target.rotation.copy(e,"XYZ")},async play(){if(this.played)return this.played=!1,void this.$emit("play",this.played);this.played=!0,this.$emit("play",this.played),this.reset(),await(0,x.default)({from:this.from,to:this.to,delay:this.delay,time:this.time,easing:this.easing,repeat:this.repeat,yoyo:this.yoyo},this.target,!1),this.played=!1,this.$emit("play",this.played)}},components:{RepeatSelector:C.A}},b=(0,a(262).A)($,[["render",function(e,t,a,x,C,$){const b=(0,o.resolveComponent)("icon"),z=(0,o.resolveComponent)("V3"),B=(0,o.resolveComponent)("FloatInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",n,[(0,o.renderSlot)(e.$slots,"default")]),(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",i,[t[13]||(t[13]=(0,o.createTextVNode)("Из: ")),["accurate"].includes(a.from.type)?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,onClick:t[0]||(t[0]=e=>$.copyFromModel(a.from))},[(0,o.createVNode)(b,{value:"target",size:"0.9em"})])):(0,o.createCommentVNode)("v-if",!0)]),(0,o.createElementVNode)("div",c,[(0,o.withDirectives)((0,o.createElementVNode)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>$.fromtype=e)},t[14]||(t[14]=[(0,o.createElementVNode)("option",{value:"accurate"},"Точная позиция",-1),(0,o.createElementVNode)("option",{value:"relative"},"Относительная позиция",-1)]),512),[[o.vModelSelect,$.fromtype]])])]),(0,o.createElementVNode)("div",s,[["accurate","relative"].includes(a.from.type)?((0,o.openBlock)(),(0,o.createBlock)(z,{key:0,"onUpdate:values":t[2]||(t[2]=e=>$.fromvalue=e),step:.1,values:$.fromvalue},null,8,["values"])):(0,o.createCommentVNode)("v-if",!0)]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",u,[t[15]||(t[15]=(0,o.createTextVNode)("В:")),["accurate"].includes(a.to.type)?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,onClick:t[3]||(t[3]=e=>$.copyFromModel(a.to))},[(0,o.createVNode)(b,{value:"target",size:"0.9em"})])):(0,o.createCommentVNode)("v-if",!0)]),(0,o.createElementVNode)("div",p,[(0,o.withDirectives)((0,o.createElementVNode)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>$.totype=e)},t[16]||(t[16]=[(0,o.createElementVNode)("option",{value:"accurate"},"Точная позиция",-1),(0,o.createElementVNode)("option",{value:"relative"},"Относительная позиция",-1)]),512),[[o.vModelSelect,$.totype]])])]),(0,o.createElementVNode)("div",m,[["accurate","relative"].includes(a.to.type)?((0,o.openBlock)(),(0,o.createBlock)(z,{key:0,"onUpdate:values":t[5]||(t[5]=e=>$.tovalue=e),step:.1,values:$.tovalue},null,8,["values"])):(0,o.createCommentVNode)("v-if",!0)]),(0,o.createElementVNode)("div",v,[t[17]||(t[17]=(0,o.createElementVNode)("div",{class:"line-title"},"Отсрочка (мсек): ",-1)),(0,o.createElementVNode)("div",y,[(0,o.createVNode)(B,{value:a.delay,min:0,decimals:0,step:10,onChanged:t[6]||(t[6]=t=>e.$emit("update","delay",t))},null,8,["value"])])]),(0,o.createElementVNode)("div",h,[t[18]||(t[18]=(0,o.createElementVNode)("div",{class:"line-title"},"Время (мсек): ",-1)),(0,o.createElementVNode)("div",f,[(0,o.createVNode)(B,{value:a.time,min:0,decimals:0,step:10,onChanged:t[7]||(t[7]=t=>e.$emit("update","time",t))},null,8,["value"])])]),(0,o.createElementVNode)("div",V,[t[20]||(t[20]=(0,o.createElementVNode)("div",{class:"line-title"},"Затухание: ",-1)),(0,o.createElementVNode)("div",N,[(0,o.withDirectives)((0,o.createElementVNode)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>$.easingval=e)},t[19]||(t[19]=[(0,o.createElementVNode)("option",{value:"Easing.Linear.InOut"},"Linear In Out",-1),(0,o.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Quadratic Out",-1),(0,o.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Cubic Out",-1)]),512),[[o.vModelSelect,$.easingval]])])]),(0,o.createElementVNode)("div",E,[t[21]||(t[21]=(0,o.createElementVNode)("div",{class:"line-title"},"Замыкание:",-1)),(0,o.createElementVNode)("div",g,[(0,o.createElementVNode)("input",{value:a.yoyo,onChange:t[9]||(t[9]=t=>e.$emit("update","yoyo",t.target.checked)),type:"checkbox"},null,40,w)])]),t[22]||(t[22]=(0,o.createElementVNode)("div",{class:"flex-line"},[(0,o.createElementVNode)("div",null,"Повторы:"),(0,o.createElementVNode)("div",null,[(0,o.createCommentVNode)(" <RepeatSelector :repeat=\"repeat\" @update:repeat=\"$emit('update','repeat',$event)\" /> ")])],-1)),(0,o.createCommentVNode)(' <div class="flex-line">\r\n            <div class="line-title">Последовательность: </div>\r\n            <div class="value-title">\r\n                <input type="checkbox">\r\n            </div>\r\n        </div> '),a.inspector?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[(0,o.createElementVNode)("button",{class:"square",onClick:t[10]||(t[10]=t=>e.$emit("play"))},[(0,o.createVNode)(b,{value:C.played?"stop2":"play3",size:"1.2em"},null,8,["value"])]),(0,o.createElementVNode)("button",{onClick:t[11]||(t[11]=t=>e.$emit("reset"))},[(0,o.createVNode)(b,{value:"undo",size:"1em"})]),(0,o.createElementVNode)("button",{onClick:t[12]||(t[12]=t=>e.$emit("remove"))},[(0,o.createVNode)(b,{value:"bin",size:"1em"})])])):(0,o.createCommentVNode)("v-if",!0)])}]])}}]);