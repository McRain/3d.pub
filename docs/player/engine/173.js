"use strict";(self.webpackChunk_reneos_3d_player_engine=self.webpackChunk_reneos_3d_player_engine||[]).push([[173,614],{30:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(922);class a extends i.B69{static get IsElement(){return!0}constructor(e){super(),this.isElement=!0,this.isBase=!0,this.uid=e.uid,this.data=e,this.type="element",this.actions=e.actions||[],e.position&&(this.position.copy(e.position),this.data.position=this.position.clone()),e.rotation&&(this.rotation.setFromVector3(e.rotation,"XYZ"),this.data.rotation=this.rotation.clone()),e.scale&&(this.scale.copy(e.scale),this.data.scale=this.scale.clone())}addAction(e){this.actions.push(e)}get model(){return this}get visible(){return super.visible}set visible(e){super.visible=e}addElement(e,t,s,i){s===this?(this.add(t),e.position&&t.position.copy(i[e.position]||e.position),e.scale&&t.scale.copy(i[e.scale]||e.scale)):s.addElement(e,t,s,i)}}const n=a},127:(e,t,s)=>{s.d(t,{A:()=>h});var i=s(922),a=s(74),n=s(351),o=s(404);let r;new i.I9Y;const c=new n.A;let l;class d{static Init(e,t){l=t,r=new a.B({element:e}),r.setSize(window.innerWidth,window.innerHeight),r.domElement.style.position="absolute",r.domElement.style.top="0px",o.A.AddToUpdate(d.Render)}static async AddElement(e,t){const s=await l(t),i=new a.v(s);return c.emit("add",i,e),i}static AddLabel(e,t){const s=new a.v(e);return s.position.set(0,0,0),s.center.set(.5,.5),s.layers.set(0),s}static AddHookLine(e,t){}static UpdateHook(e){let t=function(e,t){let s=e.getBoundingClientRect();console.log(e),console.log(s),console.log(s.top,s.right,s.bottom,s.left);let a=e.offsetParent?e.offsetParent.getBoundingClientRect():{left:0,top:0},n=(s.left-a.left+s.width/2)/window.innerWidth*2-1,o=-(s.top-a.top+s.height/2)/window.innerHeight*2+1,r=new i.Pq0(n,o,-2);r.unproject(t);let c=r.sub(t.position).normalize();return t.position.clone().add(c.multiplyScalar(3))}(e.div,o.A.Camera,o.A.Scene);e.points[1].copy(t),e.line.geometry.setFromPoints(e.points)}static Render(){r.render(o.A.Scene,o.A.Camera)}}const h=new Proxy(d,{get:(e,t)=>t in e?e[t]:c[t]})},140:(e,t,s)=>{s.d(t,{A:()=>m});var i=s(404),a=s(287),n=s(351);const o=[],r=[];let c;const l=new n.A;class d{static AddSlides(e){const t=[];for(let s=0;s<e.length;s++){const i=d.AddSlide(e[s]);t.push(i)}return t}static AddSlide(e){const t=new h(e);for(let s=0;s<e.children.length;s++){const a=e.children[s],n=new u(a,i.A.FindBlock(a.uid));n.slide=t,t.addState(n)}return o.push(t),t}static AddState(e,t=!0){const s=new u(e,i.A.FindBlock(e.uid));return t&&(s.model.visible=!0),s}static UpdateState(e,t,s){o.find((t=>t.uid===e)).children.find((e=>e.uid===t)).update(s)}static RemoveState(e,t){for(let s=0;s<o.length;s++){const i=o[s];if(t&&i.uid!==t)continue;const a=i.children.findIndex((t=>t.path===e));if(a>=0){const e=i.children.splice(a,1);t&&e.forEach((e=>e.model.visible=!1))}}}static GoTo(e){const t="number"==typeof e?o[e]:o.find((t=>t.uid===e));t&&c?.uid!==t.uid&&(r[r.length-1]!==t.uid&&r.push(t.uid),d.Activate(t))}static GoToNext(){const e=o.findIndex((e=>e===c));d.GoTo(e+1)}static GoToBack(){r.pop(),d.GoTo(r[r.length-1])}static async Activate(e,t=!1){let s=[];c&&(c.ready=!1,s=c.children,await c.out(e.children,!t)),c=e,l.emit("change",c),await c.in(s,!t)}}class h{constructor(e){this.uid=e.uid,this.name=e.name,this.scene=e.scene,this.camera=e.camera,this.type=e.type||"slide",this.isSlide=!0,this.children=[],this.ready=!0,this._actions=e.actions}addState(e){this.children.push(e),e.slide=this}async in(e,t=!0){const s=[],i=[];for(let t=0;t<this.children.length;t++){const a=this.children[t];e.findIndex((e=>e.uid===a.uid||a.data.persistent))>=0?i.push(a):s.push(a)}const n=[...s,...i];n.filter((e=>!0===e.data.visible||!1===e.data.visible)).forEach((e=>e.activate())),await Promise.all([a.A.Execute(n,"slide.in.before"),a.A.Run(this._actions,this,"slide.in.before")]),await a.A.Execute(s,"enable.on"),await Promise.all([a.A.Execute(n,"slide.in"),a.A.Run(this._actions,this,"slide.in")]),await Promise.all([a.A.Execute(n,"slide.in.after"),a.A.Run(this._actions,this,"slide.in.after")])}async out(e){const t=[],s=[];for(let i=0;i<this.children.length;i++){const a=this.children[i];e.findIndex((e=>e.uid===a.uid))>=0?t.push(a):s.push(a)}const i=[...s,...t];await Promise.all([a.A.Execute(i,"slide.out"),a.A.Run(this._actions,this,"slide.out")]),await a.A.Execute(s,"disable.on"),s.forEach((e=>e.deactivate()))}}class u{constructor(e,t){this.uid=t.uid,this.path=t.path,this.isState=!0,this.type="state",this.data=e,this.model=t,this.visible=e.visible,this._actions=e.actions||[]}addAction(e){this._actions.push(e)}get stateActions(){return this._actions}get actions(){return[...this._actions,...this.model.actions]}async activate(){this.data.position&&(this.data.position&&this.model.position.copy(this.data.position),this.data.rotation&&this.model.rotation.setFromVector3(this.data.rotation,"XYZ"),this.data.scale&&this.model.scale.copy(this.data.scale)),this.model.state=this,!0!==this.visible&&!1!==this.visible||(this.model.visible=this.visible)}deactivate(){this.model.visible=!1}}const p=new Proxy(d,{get:(e,t)=>t in e?e[t]:l[t]});window.SlidesManager=p;const m=p},173:(e,t,s)=>{s.r(t),s.d(t,{ActionsManager:()=>l.A,AssetsManager:()=>n.A,BaseElement:()=>a.C6,CssManager:()=>d.A,ElementModel:()=>a.Kx,Factory:()=>a.$7,MouseManager:()=>c.A,ProjectManager:()=>r.A,SlidesManager:()=>o.A,THREE:()=>i});var i=s(437),a=s(539),n=s(304),o=(s(314),s(140)),r=s(404),c=s(337),l=s(287),d=s(127)},287:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(140);const a={goto:function(e,t,s){i.A.GoTo(e.slide)},gonext:function(e,t,s){i.A.GoToNext()},goback:function(e,t,s){i.A.GoToBack()},func:function(e,t){let s=t;if(e.paths)for(let t=0;t<e.paths.length;t++)s=s[e.paths[t]];return s[e.method](e.values,t)},visible:async function(e,t,s){let i=t;if(e.paths)for(let t=0;t<e.paths.length;t++)i=i[e.paths[t]];if(e.target)for(let t=0;t<e.target.length;t++)i=i.children.find((s=>s.uid===e.target[t]));i.visible=e.value,i.dispatchEvent({target:i,type:"visible",value:i.visible})},propset:function(e,t,s){let i=t;for(let t=0;t<e.paths.length;t++)i=i[e.paths[t]];i[e.property]=e.value}},n={goto:{uid:"goto",type:"goto",handler:a.goto},gotoNext:{uid:"gotoNext",type:"gonext",handler:a.gonext},gotoBack:{uid:"gotoBack",type:"goback",handler:a.goback},callFunc:{uid:"callFunc",type:"func",handler:a.func},cameraSet:{uid:"cameraSet",type:"func",handler:a.func,paths:["model"],method:"activate",values:{}},visibleSet:{uid:"visibleSet",type:"visible",handler:a.visible,paths:[]},propset:{uid:"propset",type:"propset",handler:a.propset}};async function o(e,t){for(const s of e){const e=n[s.uid];await e.handler({...e,...s},t,s),s.actions&&await o(s.actions,t)}}const r=class{static get Library(){return n}static Init(e){Object.entries(e).forEach((([e,t])=>{t.handler=a[t.type],n[e]=t}))}static GetAction(e){return a[e]}static RegisterAction(e,t){a[e]=t,Object.values(n).forEach((t=>{t.type===e&&(t.handler=a[t.type])}))}static async Run(e=[],t,s){const i=e.filter((e=>e.hook===s));0!==i.length&&await o(i,t)}static async Execute(e,t){const s=[];for(let i=0;i<e.length;i++){const a=e[i],n=a.actions.filter((e=>e.hook===t));n.length>0&&s.push(o(n,a))}await Promise.all(s)}}},304:(e,t,s)=>{s.d(t,{A:()=>l});const i=class{constructor(e){this.data=e,this.resource=null,this.promise=null,this.elements=[]}async load(){}updateResource(e,t){this.resource=e,this.applyData(t||this.data)}get uid(){return this.data.uid}};var a=s(92);var n=s(922);var o=s(231);const r=new Map,c={gltf:class extends i{constructor(e){super(e)}async load(){await new Promise((e=>{(new a.B).load(this.data.url,(async t=>{let s;this.resource=t.scene.children.length>1?t.scene:t.scene.children[0],this.data.transform?.position&&this.resource.position.copy(this.data.transform.position),this.data.transform?.rotation&&this.resource.rotation.set(this.data.transform.rotation.x,this.data.transform.rotation.y,this.data.transform.rotation.z,"XYZ"),this.data.transform?.scale&&this.resource.scale.copy(this.data.transform.scale),this.data.envMap&&(s=await l.GetResource(this.data.envMap)),this.resource.traverse((e=>{e.isMesh&&(this.data.envMap&&(e.material.envMap=s,e.material.envMapIntensity=.75),e.castShadow=!0,e.receiveShadow=!0,e.geometry.computeBoundingBox())})),e()}))}))}setElement(e,t={}){this.elements.push({element:e,data:t}),e.add(this.resource.clone()),this.applyData(t)}updateResource(e,t){super.updateResource(e,t);for(let t=0;t<this.elements.length;t++){const t=this.elements,s=t.element.children.find((e=>e.uid===this.data.uid));s!==e&&(t.element.remove(s),t.element.add(this.resource.clone())),this.applyData(t.data)}}async applyData(e){let t;this.resource.position.copy(e.transform?.position||{x:0,y:0,z:0}),this.resource.rotation.setFromVector3(e.transform?.rotation||{x:0,y:0,z:0},"XYZ"),this.resource.scale.copy(e.transform?.scale||{x:1,y:1,z:1}),e.transform?.quaternion&&this.resource.quaternion.copy(e.transform.quaternion),e.envMap&&(t=await l.GetAsset(e.envMap).resource),this.resource.traverse((s=>{s.isMesh&&(e.envMap&&(s.material.envMap=t),s.castShadow=e.shadow?.cast||!1,s.receiveShadow=e.shadow?.receive||!1,s.geometry.computeBoundingBox())}))}destroy(){for(let e=0;e<this.elements.length;e++){const e=this.elements;e.elements.children.find((e=>e.uid===this.data.uid))&&e.elements.remove(this.resource)}}},texture:class extends i{constructor(e){super(e)}async load(){const e=new n.Tap;this.resource=await e.load(this.data.url)}setElement(e,t={}){this.element=e,this.elementData=t,this.element.add(this.resource),this.applyData(this.data),this.applyData(this.elementData)}updateResource(e,t){this.element.children.find((e=>e.uid===this.data.uid))!==e&&(this.element.remove(this.resource),this.resource=e,this.element.add(this.resource)),this.applyData(t),this.applyData(this.elementData)}destroy(){this.element.children.find((e=>e.uid===this.data.uid))&&this.element.remove(this.resource)}},hdr:class extends i{constructor(e){super(e)}load(){return new Promise((e=>{(new o.Y).load(this.data.url,(t=>{t.mapping=n.wfO,this.resource=t,e()}))}))}setElement(e,t={}){this.element=e,this.elementData=t,this.element.add(this.resource),this.applyData(this.data),this.applyData(this.elementData)}updateResource(e,t){this.element.children.find((e=>e.uid===this.data.uid))!==e&&(this.element.remove(this.resource),this.resource=e,this.element.add(this.resource)),this.applyData(t),this.applyData(this.elementData)}destroy(){this.element.children.find((e=>e.uid===this.data.uid))&&this.element.remove(this.resource)}},material:class extends i{constructor(e){super(e),this.resource=new n._4j,this.elements=[]}async load(){Object.keys(this.data.textures).forEach((async e=>{this.resource[e]=await l.GetResource(this.data.textures[e].uid)})),Object.keys(this.data.properties).forEach((async e=>{this.resource[e]=this.data.properties[e]}))}setElement(e,t={}){this.elements.push({element:e,data:t}),e.add(this.resource.clone()),this.applyData(t)}updateResource(e,t){for(let s=0;s<this.elements.length;s++){const s=this.elements;s.element.children.find((e=>e.uid===this.data.uid))!==e&&(s.element.remove(this.resource),this.resource=e,s.element.add(this.resource.clone())),this.applyData(t),this.applyData(s.data)}}}},l=class{static GetAsset(e){return r.get(e)}static GetAssets(e){const t=new Set(e);return[...r.values()].filter((e=>t.has(e.uid)))}static GetResource(e){const t=r.get(e);return t.resource?t.resource:(t.promise||(t.promise=new Promise((async e=>{await t.load(),e(t.resource)}))),t.promise)}static async Init(e){for(let t=0;t<e.length;t++){const s=e[t],i=new(0,c[s.type])(s);r.set(i.uid,i)}const t=[];for(const[e,s]of r.entries())t.push(s.load());await Promise.allSettled(t)}static RemoveAsset(e){r.has(e.uid)&&(r.get(e.uid).destroy(),r.delete(e.uid))}}},314:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var i=s(30);class a extends i.A{constructor(e){super(e),this.isBlock=!0,this.type="block"}}const n=a},337:(e,t,s)=>{s.d(t,{A:()=>k});var i=s(922),a=s(351);function n(e){for(;e;){if(e.isBlock)return e;e=e.parent}return null}var o=s(24);let r,c;const l=class{static MoveTo(e,t){const s={position:new i.Pq0,time:1e3,...e,control:!1},a={position:new i.Pq0,time:1e3,...t,control:!1};r.enabled=!1;const n=Workspace.Camera.position.clone(),o=r.target.clone();s.control=s.time>a.time,a.control=a.time>=s.time;const c=new Tween(n).to(s.position,s.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{Workspace.Camera.position.copy(n),Workspace.Camera.updateProjectionMatrix(),r.update()})).onComplete((()=>{s.control&&(r.enabled=!0),tweengroup.remove(c)})).start(),l=new Tween(o).to(a.position,a.time).easing(Easing.Quadratic.InOut).onUpdate((()=>{r.target.copy(o),r.getPolarAngle()>r.maxPolarAngle&&r.target.setY(center.y+Math.cos(r.maxPolarAngle)*distance)})).onComplete((()=>{a.control&&(r.enabled=!0),tweengroup.remove(l)})).start();tweengroup.add(c,l)}static SetState(e){r.enabled=e}static Target(e){r.target.copy(e)}static Init({canvas:e},t,s){r&&s.remove(r),r=new o.N(t,e),r.enabled=!0,r.enableDamping=!0,r.dampingFactor=.25,r.screenSpacePanning=!1,r.minDistance=.01,r.maxDistance=500}static ChangeCamera(e){r.object=e}static get Transformer(){return c}static Select(e){e?c.attach(e):c.detach()}static Update(e){r.update(e)}static FitTo({center:e,radius:t}){const s=i.cj9.degToRad(Workspace.Camera.fov),a=t/Math.sin(s/2),n=(new i.Pq0).subVectors(Workspace.Camera.position,e).normalize(),o=e.clone().add(n.multiplyScalar(a)),c=Workspace.Camera.position.clone();r.enabled=!1;const l=r.target.clone(),d=new Tween(l).to(e,1e3).easing(Easing.Quadratic.InOut).onUpdate((()=>{r.target.copy(l),r.getPolarAngle()>r.maxPolarAngle&&r.target.setY(e.y+Math.cos(r.maxPolarAngle)*distance)})).start(),h=new Tween(c).to(o,1e3).easing(Easing.Quadratic.InOut).onUpdate((()=>{Workspace.Camera.position.copy(c);const t=Workspace.Camera.position.distanceTo(e);t<r.minDistance?Workspace.Camera.position.copy(e.clone().add(n.clone().multiplyScalar(r.minDistance))):t>r.maxDistance&&Workspace.Camera.position.copy(e.clone().add(n.clone().multiplyScalar(r.maxDistance))),Workspace.Camera.updateProjectionMatrix(),r.update()})).onComplete((()=>{r.enabled=!0,tweengroup.remove(h,d)})).start();tweengroup.add(h,d)}},d=new i.tBo,h=new a.A;let u,p,m,f;const g={x:0,y:0};let y,w=.03,v=.03,A=.01,b=.01,x=window.innerWidth/2,E=window.innerHeight/2;function S(e){}function C(e){g.x=e.clientX,g.y=e.clientY,y=Date.now()}function P(e){if(Math.abs(g.x-e.clientX)>10||Math.abs(g.y-e.clientY)>10||Date.now()-y>500)return;const t=e.clientX/window.innerWidth,s=-e.clientY/window.innerHeight,a=new i.I9Y;a.x=2*t-1,a.y=2*s+1,d.setFromCamera(a,p);const o=d.intersectObjects(u.children,!0);if(0===o.length)return;const r=[];for(let e=0;e<o.length;e++){const t=n(o[e].object);if(t.visible&&!r.includes(t))return r.push(t),void h.emit("click",t)}}const k=new Proxy(class{static get Control(){return l}static Init(e,t,s,i,a){const n={camera:{range:{x:.01,y:.01},movespeed:{x:.03,y:.03}},...a};u=i,m=s,p=t,f=e,w=n.camera.movespeed.x,v=n.camera.movespeed.y,A=n.camera.range.x,b=n.camera.range.y,x=window.innerWidth/2,E=window.innerHeight/2,e.addEventListener("click",P.bind(null)),e.addEventListener("mousemove",S,!1),e.addEventListener("mousedown",C,!1)}static Update(e){}static SetCamera(e){p=e}},{get:(e,t)=>t in e?e[t]:h[t]})},351:(e,t,s)=>{s.d(t,{A:()=>i});const i=class{constructor(){this._events={"*":[]}}subs(e,t,s){null==this._events[e]&&(this._events[e]=[]),this._events[e].push({handler:s,once:t})}on(e,t){this.subs(e,!1,t)}once(e,t){this.subs(e,!0,t)}off(e,t){const s=this._events[e];if(s){for(let e=s.length-1;e>=0;e--)s[e].handler===t&&s.splice(e,1);0===s.length&&delete this._events[e]}}clear(e){this._events[e]=[]}clearAll(){this._events={"*":[]}}emit(e,...t){const s=[];this._events[e]&&s.push(...this._events[e]),this._events["*"].length&&s.push(...this._events["*"].map((t=>({handler:t.handler.bind(this,e),once:t.once}))));for(let e=s.length-1;e>=0;e--){const i=s[e];i.handler.apply(null,t),i.once&&s.splice(e,1)}}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}}},404:(e,t,s)=>{s.d(t,{A:()=>b});var i=s(922),a=s(437),n=s(351),o=s(539),r=s(304),c=s(337),l=s(287);let d,h,u,p,m,f,g,y=[];const w=new n.A,v=[];function A(e){for(let t=0;t<y.length;t++)y[t](e);p.render(u,f)}const b=new Proxy(class{static get Root(){return m}static get Scene(){return u}static get Camera(){return f}static get Canvas(){return d}static Init(e){d=e,h=new i.zD7,u=new i.Z58,p=new a.WebGLRenderer({canvas:e,alpha:!0,powerPreference:"high-performance",antialias:!0,stencil:!1});const t=d.clientWidth,s=d.clientHeight;p.setSize(t,s,!1),p.setPixelRatio(window.devicePixelRatio),p.shadowMap.enabled=!0,p.shadowMap.type=i.Wk7,m=new i.B69,u.add(m),g=m.position.clone()}static async Start(){f=new i.ubm(60,window.innerWidth/window.innerHeight,.01,1e3),f.uid="EditorCamera",u.add(f),f.position.set(0,10,20),p.setAnimationLoop(A),f.layers.enable(1),c.A.Init(p.domElement,f,u,m),c.A.on("click",(e=>{l.A.Run([...e.actions,...e.state.actions],e,"mouse.click.self")})),y.push(c.A.Update),u.background=await r.A.GetAsset("hdrscene").resource}static AddToUpdate(e){y.push(e)}static SetCamera(e){f.visible=!1,f=e,f.visible=!0,c.A.SetCamera(f)}static async Build(e){const t=await o.$7.BuildElements(e,m);return t.forEach((e=>e.visible=!1)),v.push(...t),t}static FindBlock(e){return v.find((t=>t.uid===e))}static FindElement(e){let t=v.find((t=>t.uid===e[0]));for(let s=1;s<e.length;s++)t=t.children.find((t=>t.uid===e[s]));return t}static async SetAsset(e,t){const s=await r.A.GetAsset({uid:t.uid}),i=e.split(".");let a=v.find((e=>e.uid===i[0]));for(let e=1;e<i.length;e++)a=a.children.find((t=>t.uid===i[e]));a.addAsset(t,s)}static RemoveAsset(e,t){const s=e.split(".");let i=v.find((e=>e.uid===s[0]));for(let e=1;e<s.length;e++)i=i.children.find((t=>t.uid===s[e]));i.removeAsset(t)}static RemoveElement(e){const t=e.split(".");let s=v;for(let e=0;e<t.length-1;e++){const i=s.find((s=>s.uid===t[e]));s=i.children}const i=s.findIndex((t=>t.path===e));if(i>=0){const e=s.splice(i,1);e[0].parent.remove(e[0])}}},{get:(e,t)=>t in e?e[t]:w[t]})},539:(e,t,s)=>{s.d(t,{$7:()=>h,C6:()=>a.A,Kx:()=>n.default});var i=s(922),a=s(30),n=s(614),o=s(304);const r={PlaneGeometry:i.bdM,SphereGeometry:i.Gu$,BoxGeometry:i.iNn,BufferGeometry:i.LoY,Group:i.YJl,Object3D:i.B69,PerspectiveCamera:i.ubm,OrthographicCamera:i.qUd,InstancedMesh:i.ZLX,Mesh:i.eaF,DirectionalLight:i.ZyN,AmbientLight:i.$p8,Color:i.Q1f,Vector3:i.Pq0,Vector2:i.I9Y,Quaternion:i.PTz,Matrix4:i.kn4,MeshLambertMaterial:i.G_z,MeshPhysicalMaterial:i.uSd,MeshStandardMaterial:i._4j,BufferAttribute:i.THS},c=[{types:["block"],module:()=>Promise.resolve().then(s.bind(s,314))},{types:["model"],module:()=>Promise.resolve().then(s.bind(s,614))},{types:["camera"],module:()=>s.e(740).then(s.bind(s,740))},{types:["directlight"],module:()=>s.e(296).then(s.bind(s,296))},{types:["material"],module:e=>e=>{console.log(e)}},{types:["uielement"],module:()=>s.e(229).then(s.bind(s,229))}],l={},d={};class h{static AddImporter(e,t){c.push({types:e,handler:t})}static AddTemplate(e){l[e.id]=element}static AddTemplates(e){e.forEach((e=>{l[e.id]=e}))}static GetElementProp(e,t){let s=d[e];const i=t.split(".");for(let e=0;e<i.length;e++)s=s[i[e]];return s}static async UpdateElement(e,t){const s=d[e];Object.keys(t).forEach((async e=>{s[e]=await h.CreateElement(t[e])}))}static async CreateElement(e){if(null==e)return null;let t=e;if("object"==typeof e){const{type:s,properties:i,asset:a}=e;if(s){let i;const{args:a,...n}=e,l=c.find((e=>e.types.includes(s.toLowerCase())));if(l){const t=l.handler?l.handler(e):await l.module();i=t.default||t}else r[s]&&(i=r[s]);if(Array.isArray(a)){const e=await Promise.all(a.map((e=>h.CreateElement(e))));t=new i(...e)}else a?t=new i(Object.fromEntries(await Promise.all(Object.entries(a).map((async([e,t])=>[e,await h.CreateElement(t)]))))):r[s]||(t=new i(n));if(n.assets){const e=o.A.GetAssets(n.assets.map((e=>e.uid)));t.setAssets(e,n.assets)}t.isObject3D&&(t.isElement||(t.actions=[],t.isElement=!0),t.paths=e.paths)}else a&&(t=await o.A.GetResource(a));i&&await Promise.all(Object.entries(i).map((async([e,s])=>{t[e]=await h.CreateElement(s)})))}return t}static async BuildElements(e,t){const s=[];for(let i=0;i<e.length;i++){const a=e[i],n=await h.BuildElement(a,t);s.push(n)}return s}static async BuildElement(e,t){const s=structuredClone(l[e.template]?{...l[e.template],...e}:JSON.parse(JSON.stringify(e))),{uid:i,name:a}=s,n=await h.CreateElement(s);if(n)return n.uid=i,n.name=a||i,n.path=t.path?`${t.path}.${i}`:i,t&&(t.addChild||t.add).bind(t)(n),e.children&&await h.BuildElements(e.children,n),d[n.uid]=n,n.init&&await n.init(),n}}},614:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var i=s(30);class a extends i.A{constructor(e){super(e),this.isModel=!0,this.type="model"}setAssets(e,t){for(let s=0;s<t.length;s++)this.add(...e.map((e=>e.resource.clone())))}removeAsset(e){const t=this.children.find((t=>t.uid===e));t&&this.remove(t)}addAsset(e,t){t.position.copy(e.transform?.position||{x:0,y:0,z:0}),t.rotation.setFromVector3(e.transform?.rotation||{x:0,y:0,z:0},"XYZ"),t.scale.copy(e.transform?.scale||{x:1,y:1,z:1}),e.transform?.quaternion&&t.quaternion.copy(e.transform?.quaternion),t.traverse((e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.geometry.computeBoundingBox())})),this.add(t)}find(e){const t=e.split(".");let s=this;for(let e=0;e<t.length;e++)s=this.children.find((s=>s.uid===t[e])),list=s.children;return s}}const n=a}}]);