"use strict";(self.webpackChunk_reneos_3d_mod_tweens=self.webpackChunk_reneos_3d_mod_tweens||[]).push([[637,927],{70:(e,t,o)=>{o.d(t,{A:()=>i});const a=new(o(232).Group);let l=!1;class n{static get Group(){return a}static Add(e){a.add(e),l||(l=!0,n.Update())}static Remove(e){a.remove(e),0===a.getAll().length&&(l=!1)}static Update(e){l&&(a.update(e),requestAnimationFrame(n.Update))}}const i=n},195:(e,t,o)=>{o.r(t),o.d(t,{default:()=>n});var a=o(232),l=o(70);function n(e,t,o){return new Promise((n=>{o.tween&&(o.tween.stop(),l.A.Remove(o.tween));let i=t;if(e.paths)for(let t=0;t<e.paths.length;t++)i=i[e.paths[t]];if(e.target)for(let t=0;t<e.target.length;t++)i=i.childrens.find((o=>o.uid===e.target[t]));const c="accurate"===e.from.type?{...e.from.value}:{x:i.model.position.x+e.from.value.x,y:i.model.position.y+e.from.value.y,z:i.model.position.z+e.from.value.z};let r=e.transform?.position||i.model.position;if("target"===e.to.type){let o=t.slide||t;for(let t=0;t<e.to.paths.length;t++)o=o.childrens.find((o=>o.uid===e.to.paths[t]));r=o.transform?.position||o.model.position}const s="accurate"===e.to.type?e.to.value:{x:r.x+e.to.value.x,y:r.y+e.to.value.y,z:r.z+e.to.value.z};console.log("Tween pos from ",c," to ",s," target ",i.uid),i.model.position.copy(c),o.tween=new a.Tween(c).to(s,e.time||1e3).delay(e.delay+300*Math.random()||0).easing(a.Easing.Quadratic.InOut).yoyo(e.yoyo).repeat(e.repeat).onUpdate((()=>{i.model.position.copy(c)})).onComplete((()=>{l.A.Remove(o.tween),o.tween=null,console.log(`${o.hook}:${t.uid} Complete `,c," TO ",s),n()})),o.tween.start(),l.A.Add(o.tween)}))}},262:(e,t)=>{t.A=(e,t)=>{const o=e.__vccOpts||e;for(const[e,a]of t)o[e]=a;return o}},652:(e,t,o)=>{o.d(t,{A:()=>i});var a=o(655);const l={style:{display:"flex","flex-wrap":"nowrap",gap:"10px","justify-content":"flex-end"}},n={props:{repeat:{type:[Number],required:!0}},computed:{rep:{get(){return this.repeat},set(e){this.$emit("update:repeat",e)}}},watch:{infin(e){this.$emit("update:repeat",e?1/0:this.inputRepeat)}},data(){return{inputRepeat:this.repeat,infin:!1}}},i=(0,o(262).A)(n,[["render",function(e,t,o,n,i,c){const r=(0,a.resolveComponent)("icon");return(0,a.openBlock)(),(0,a.createElementBlock)("div",l,[i.infin?(0,a.createCommentVNode)("v-if",!0):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:0,style:{width:"42px",height:"0.98em"},type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>c.rep=e),min:"0"},null,512)),[[a.vModelText,c.rep,void 0,{number:!0}]]),(0,a.createVNode)(r,{style:(0,a.normalizeStyle)({opacity:i.infin?1:.5}),value:"infinite",size:"1em"},null,8,["style"]),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.infin=e),type:"checkbox"},null,512),[[a.vModelCheckbox,i.infin]])])}]])},933:(e,t,o)=>{o.r(t),o.d(t,{default:()=>B});var a=o(655);const l={class:"vertflex"},n={class:"flex-line"},i={class:"value-title"},c={class:"flex-line"},r={class:"line-title"},s={class:"value-title"},d={class:"flex-fit"},p={class:"flex-line"},m={class:"line-title"},u={class:"value-title"},v={class:"flex-fit"},y={class:"flex-line"},f={class:"value-title"},V={class:"flex-line"},h={class:"value-title"},N={class:"flex-line"},E={class:"value-title"},g={class:"flex-line"},k={class:"value-title"},x={class:"flex-line"},w={class:"flex-fit",style:{"justify-content":"center"}};o(232);var C=o(195),b=o(652);const z={name:"TweenPos",props:["actionuid","selecteduid"],data:()=>({played:!1,act:{}}),computed:{action(){return this.$app.actions.list[this.actionuid]},target(){return this.$app.selection.selected},transform(){return this.$app.selection.selected.model?.transform||this.$app.selection.selected.transform}},methods:{copyFromModel(e){const t=this.target.model.position.clone();e.value.x=t.x,e.value.y=t.y,e.value.z=t.z},reset(){const e=this.target.transform.position||this.target.model?.transform?.position||this.target.model.position;this.target.model?this.target.model.position.copy(e):this.target.position.copy(e)},async play(){if(this.played)return this.played=!1,void this.$emit("play",this.played);this.played=!0,this.$emit("play",this.played),this.reset(),await(0,C.default)(this.action,this.target,this.act),this.played=!1,this.$emit("play",this.played)}},components:{RepeatSelector:b.A}},B=(0,o(262).A)(z,[["render",function(e,t,o,C,b,z){const B=(0,a.resolveComponent)("icon"),A=(0,a.resolveComponent)("V3"),U=(0,a.resolveComponent)("FloatInput"),$=(0,a.resolveComponent)("RepeatSelector");return(0,a.openBlock)(),(0,a.createElementBlock)("div",l,[(0,a.createElementVNode)("div",n,[t[14]||(t[14]=(0,a.createElementVNode)("div",{class:"line-title"},"Тип: ",-1)),(0,a.createElementVNode)("div",i,(0,a.toDisplayString)(z.action.type),1)]),(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",r,[t[15]||(t[15]=(0,a.createTextVNode)("Из: ")),["accurate"].includes(z.action.from.type)?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:t[0]||(t[0]=e=>z.copyFromModel(z.action.from))},[(0,a.createVNode)(B,{value:"target",size:"0.9em"})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",s,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>z.action.from.type=e)},t[16]||(t[16]=[(0,a.createElementVNode)("option",{value:"accurate"},"Точная позиция",-1),(0,a.createElementVNode)("option",{value:"relative"},"Относительная позиция",-1)]),512),[[a.vModelSelect,z.action.from.type]])])]),(0,a.createElementVNode)("div",d,[["accurate","relative"].includes(z.action.from.type)?((0,a.openBlock)(),(0,a.createBlock)(A,{key:0,"onUpdate:values":t[2]||(t[2]=e=>z.action.from.value=e),step:.1,values:z.action.from.value},null,8,["values"])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",p,[(0,a.createElementVNode)("div",m,[t[17]||(t[17]=(0,a.createTextVNode)("В:")),["accurate"].includes(z.action.to.type)?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:t[3]||(t[3]=e=>z.copyFromModel(z.action.to))},[(0,a.createVNode)(B,{value:"target",size:"0.9em"})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",u,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>z.action.to.type=e)},t[18]||(t[18]=[(0,a.createElementVNode)("option",{value:"accurate"},"Точная позиция",-1),(0,a.createElementVNode)("option",{value:"relative"},"Относительная позиция",-1)]),512),[[a.vModelSelect,z.action.to.type]])])]),(0,a.createElementVNode)("div",v,[["accurate","relative"].includes(z.action.to.type)?((0,a.openBlock)(),(0,a.createBlock)(A,{key:0,"onUpdate:values":t[5]||(t[5]=e=>z.action.to.value=e),step:.1,values:z.action.to.value},null,8,["values"])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",y,[t[19]||(t[19]=(0,a.createElementVNode)("div",{class:"line-title"},"Отсрочка (мсек): ",-1)),(0,a.createElementVNode)("div",f,[(0,a.createVNode)(U,{value:z.action.delay,min:0,decimals:0,step:10,onChanged:t[6]||(t[6]=e=>z.action.delay=e)},null,8,["value"])])]),(0,a.createElementVNode)("div",V,[t[20]||(t[20]=(0,a.createElementVNode)("div",{class:"line-title"},"Время (мсек): ",-1)),(0,a.createElementVNode)("div",h,[(0,a.createVNode)(U,{value:z.action.time,min:0,decimals:0,step:10,onChanged:t[7]||(t[7]=e=>z.action.time=e)},null,8,["value"])])]),(0,a.createElementVNode)("div",N,[t[22]||(t[22]=(0,a.createElementVNode)("div",{class:"line-title"},"Затухание: ",-1)),(0,a.createElementVNode)("div",E,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>z.action.easing=e)},t[21]||(t[21]=[(0,a.createElementVNode)("option",{value:"Easing.Linear.InOut"},"Linear In Out",-1),(0,a.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Quadratic Out",-1),(0,a.createElementVNode)("option",{value:"Easing.Quadratic.InOut"},"Cubic Out",-1)]),512),[[a.vModelSelect,z.action.easing]])])]),(0,a.createElementVNode)("div",g,[t[23]||(t[23]=(0,a.createElementVNode)("div",{class:"line-title"},"Замыкание:",-1)),(0,a.createElementVNode)("div",k,[(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>z.action.yoyo=e),type:"checkbox"},null,512),[[a.vModelCheckbox,z.action.yoyo]])])]),(0,a.createElementVNode)("div",x,[t[24]||(t[24]=(0,a.createElementVNode)("div",null,"Повторы:",-1)),(0,a.createElementVNode)("div",null,[(0,a.createVNode)($,{repeat:z.action.repeat,"onUpdate:repeat":t[10]||(t[10]=e=>z.action.repeat=e)},null,8,["repeat"])])]),(0,a.createCommentVNode)(' <div class="flex-line">\r\n            <div class="line-title">Последовательность: </div>\r\n            <div class="value-title">\r\n                <input type="checkbox">\r\n            </div>\r\n        </div> '),(0,a.createElementVNode)("div",w,[(0,a.createElementVNode)("button",{class:"square",onClick:t[11]||(t[11]=(...e)=>z.play&&z.play(...e))},[(0,a.createVNode)(B,{value:b.played?"stop2":"play3",size:"1.2em"},null,8,["value"])]),(0,a.createElementVNode)("button",{onClick:t[12]||(t[12]=(...e)=>z.reset&&z.reset(...e))},[(0,a.createVNode)(B,{value:"undo",size:"1em"})]),(0,a.createElementVNode)("button",{onClick:t[13]||(t[13]=(...t)=>e.remove&&e.remove(...t))},[(0,a.createVNode)(B,{value:"bin",size:"1em"})])])])}]])}}]);